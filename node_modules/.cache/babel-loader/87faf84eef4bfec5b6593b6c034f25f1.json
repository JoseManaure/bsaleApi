{"ast":null,"code":"import _objectSpread from \"/Users/jnanaure87/Desktop/Web_Personal_IC_ConBsaleProductos/web-personal-client-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/Users/jnanaure87/Desktop/Web_Personal_IC_ConBsaleProductos/web-personal-client-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/jnanaure87/Desktop/Web_Personal_IC_ConBsaleProductos/web-personal-client-master/src/components/Admin/Users/EditUserForm/EditUserForm.js\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { Avatar, Form, Icon, Input, Select, Button, Row, Col, notification } from \"antd\";\nimport { useDropzone } from \"react-dropzone\";\nimport NoAvatar from \"../../../../assets/img/png/no-avatar.png\";\nimport { updateUserApi, uploadAvatarApi, getAvatarApi } from \"../../../../api/user\";\nimport { getAccessTokenApi } from \"../../../../api/auth\";\nimport \"./EditUserForm.scss\";\nexport default function EditUserForm(props) {\n  const user = props.user,\n        setIsVisibleModal = props.setIsVisibleModal,\n        setReloadUsers = props.setReloadUsers;\n\n  const _useState = useState(null),\n        _useState2 = _slicedToArray(_useState, 2),\n        avatar = _useState2[0],\n        setAvatar = _useState2[1];\n\n  const _useState3 = useState({}),\n        _useState4 = _slicedToArray(_useState3, 2),\n        userData = _useState4[0],\n        setUserData = _useState4[1];\n\n  useEffect(() => {\n    setUserData({\n      name: user.name,\n      lastname: user.lastname,\n      email: user.email,\n      role: user.role,\n      avatar: user.avatar\n    });\n  }, [user]);\n  useEffect(() => {\n    if (user.avatar) {\n      getAvatarApi(user.avatar).then(response => {\n        setAvatar(response);\n      });\n    } else {\n      setAvatar(null);\n    }\n  }, [user]);\n  useEffect(() => {\n    if (avatar) {\n      setUserData(_objectSpread({}, userData, {\n        avatar: avatar.file\n      }));\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [avatar]);\n\n  const updateUser = e => {\n    e.preventDefault();\n    const token = getAccessTokenApi();\n    let userUpdate = userData;\n\n    if (userUpdate.password || userUpdate.repeatPassword) {\n      if (userUpdate.password !== userUpdate.repeatPassword) {\n        notification[\"error\"]({\n          message: \"Las contraseÃ±as tienen que ser iguales.\"\n        });\n        return;\n      } else {\n        delete userUpdate.repeatPassword;\n      }\n    }\n\n    if (!userUpdate.name || !userUpdate.lastname || !userUpdate.email) {\n      notification[\"error\"]({\n        message: \"El nombre, apellidos y email son obligatorios.\"\n      });\n      return;\n    }\n\n    if (typeof userUpdate.avatar === \"object\") {\n      uploadAvatarApi(token, userUpdate.avatar, user._id).then(response => {\n        userUpdate.avatar = response.avatarName;\n        updateUserApi(token, userUpdate, user._id).then(result => {\n          notification[\"success\"]({\n            message: result.message\n          });\n          setIsVisibleModal(false);\n          setReloadUsers(true);\n        });\n      });\n    } else {\n      updateUserApi(token, userUpdate, user._id).then(result => {\n        notification[\"success\"]({\n          message: result.message\n        });\n        setIsVisibleModal(false);\n        setReloadUsers(true);\n      });\n    }\n  };\n\n  return React.createElement(\"div\", {\n    className: \"edit-user-form\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, React.createElement(UploadAvatar, {\n    avatar: avatar,\n    setAvatar: setAvatar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }), React.createElement(EditForm, {\n    userData: userData,\n    setUserData: setUserData,\n    updateUser: updateUser,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }));\n}\n\nfunction UploadAvatar(props) {\n  const avatar = props.avatar,\n        setAvatar = props.setAvatar;\n\n  const _useState5 = useState(null),\n        _useState6 = _slicedToArray(_useState5, 2),\n        avatarUrl = _useState6[0],\n        setAvatarUrl = _useState6[1];\n\n  useEffect(() => {\n    if (avatar) {\n      if (avatar.preview) {\n        setAvatarUrl(avatar.preview);\n      } else {\n        setAvatarUrl(avatar);\n      }\n    } else {\n      setAvatarUrl(null);\n    }\n  }, [avatar]);\n  const onDrop = useCallback(acceptedFiles => {\n    const file = acceptedFiles[0];\n    setAvatar({\n      file,\n      preview: URL.createObjectURL(file)\n    });\n  }, [setAvatar]);\n\n  const _useDropzone = useDropzone({\n    accept: \"image/jpeg, image/png\",\n    noKeyboard: true,\n    onDrop\n  }),\n        getRootProps = _useDropzone.getRootProps,\n        getInputProps = _useDropzone.getInputProps,\n        isDragActive = _useDropzone.isDragActive;\n\n  return React.createElement(\"div\", Object.assign({\n    className: \"upload-avatar\"\n  }, getRootProps(), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }), React.createElement(\"input\", Object.assign({}, getInputProps(), {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145\n    },\n    __self: this\n  })), isDragActive ? React.createElement(Avatar, {\n    size: 150,\n    src: NoAvatar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }) : React.createElement(Avatar, {\n    size: 150,\n    src: avatarUrl ? avatarUrl : NoAvatar,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }));\n}\n\nfunction EditForm(props) {\n  const userData = props.userData,\n        setUserData = props.setUserData,\n        updateUser = props.updateUser;\n  const Option = Select.Option;\n  return React.createElement(Form, {\n    className: \"form-edit\",\n    onSubmit: updateUser,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }, React.createElement(Row, {\n    gutter: 24,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161\n    },\n    __self: this\n  }, React.createElement(Col, {\n    span: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(Input, {\n    prefix: React.createElement(Icon, {\n      type: \"user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165\n      },\n      __self: this\n    }),\n    placeholder: \"Nombre\",\n    value: userData.name,\n    onChange: e => setUserData(_objectSpread({}, userData, {\n      name: e.target.value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }))), React.createElement(Col, {\n    span: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172\n    },\n    __self: this\n  }, React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, React.createElement(Input, {\n    prefix: React.createElement(Icon, {\n      type: \"user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175\n      },\n      __self: this\n    }),\n    placeholder: \"Apellidos\",\n    value: userData.lastname,\n    onChange: e => setUserData(_objectSpread({}, userData, {\n      lastname: e.target.value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  })))), React.createElement(Row, {\n    gutter: 24,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186\n    },\n    __self: this\n  }, React.createElement(Col, {\n    span: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  }, React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188\n    },\n    __self: this\n  }, React.createElement(Input, {\n    prefix: React.createElement(Icon, {\n      type: \"mail\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190\n      },\n      __self: this\n    }),\n    placeholder: \"Correo electronico\",\n    value: userData.email,\n    onChange: e => setUserData(_objectSpread({}, userData, {\n      email: e.target.value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189\n    },\n    __self: this\n  }))), React.createElement(Col, {\n    span: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199\n    },\n    __self: this\n  }, React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200\n    },\n    __self: this\n  }, React.createElement(Select, {\n    placeholder: \"Selecci\\xF3na una rol\",\n    onChange: e => setUserData(_objectSpread({}, userData, {\n      role: e\n    })),\n    value: userData.role,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201\n    },\n    __self: this\n  }, React.createElement(Option, {\n    value: \"admin\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206\n    },\n    __self: this\n  }, \"Administrador\"), React.createElement(Option, {\n    value: \"editor\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207\n    },\n    __self: this\n  }, \"Editor\"), React.createElement(Option, {\n    value: \"reviewr\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208\n    },\n    __self: this\n  }, \"Revisor\"))))), React.createElement(Row, {\n    gutter: 24,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214\n    },\n    __self: this\n  }, React.createElement(Col, {\n    span: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215\n    },\n    __self: this\n  }, React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216\n    },\n    __self: this\n  }, React.createElement(Input, {\n    prefix: React.createElement(Icon, {\n      type: \"lock\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218\n      },\n      __self: this\n    }),\n    type: \"password\",\n    placeholder: \"Contrase\\xF1a\",\n    onChange: e => setUserData(_objectSpread({}, userData, {\n      password: e.target.value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217\n    },\n    __self: this\n  }))), React.createElement(Col, {\n    span: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  }, React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, React.createElement(Input, {\n    prefix: React.createElement(Icon, {\n      type: \"lock\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230\n      },\n      __self: this\n    }),\n    type: \"password\",\n    placeholder: \"Repetir contrase\\xF1a\",\n    onChange: e => setUserData(_objectSpread({}, userData, {\n      repeatPassword: e.target.value\n    })),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  })))), React.createElement(Form.Item, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241\n    },\n    __self: this\n  }, React.createElement(Button, {\n    type: \"primary\",\n    htmlType: \"submit\",\n    className: \"btn-submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242\n    },\n    __self: this\n  }, \"Actualizar Usuario\")));\n}","map":{"version":3,"sources":["/Users/jnanaure87/Desktop/Web_Personal_IC_ConBsaleProductos/web-personal-client-master/src/components/Admin/Users/EditUserForm/EditUserForm.js"],"names":["React","useState","useEffect","useCallback","Avatar","Form","Icon","Input","Select","Button","Row","Col","notification","useDropzone","NoAvatar","updateUserApi","uploadAvatarApi","getAvatarApi","getAccessTokenApi","EditUserForm","props","user","setIsVisibleModal","setReloadUsers","avatar","setAvatar","userData","setUserData","name","lastname","email","role","then","response","file","updateUser","e","preventDefault","token","userUpdate","password","repeatPassword","message","_id","avatarName","result","UploadAvatar","avatarUrl","setAvatarUrl","preview","onDrop","acceptedFiles","URL","createObjectURL","accept","noKeyboard","getRootProps","getInputProps","isDragActive","EditForm","Option","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport {\n  Avatar,\n  Form,\n  Icon,\n  Input,\n  Select,\n  Button,\n  Row,\n  Col,\n  notification\n} from \"antd\";\nimport { useDropzone } from \"react-dropzone\";\nimport NoAvatar from \"../../../../assets/img/png/no-avatar.png\";\nimport {\n  updateUserApi,\n  uploadAvatarApi,\n  getAvatarApi\n} from \"../../../../api/user\";\nimport { getAccessTokenApi } from \"../../../../api/auth\";\n\nimport \"./EditUserForm.scss\";\n\nexport default function EditUserForm(props) {\n  const { user, setIsVisibleModal, setReloadUsers } = props;\n  const [avatar, setAvatar] = useState(null);\n  const [userData, setUserData] = useState({});\n\n  useEffect(() => {\n    setUserData({\n      name: user.name,\n      lastname: user.lastname,\n      email: user.email,\n      role: user.role,\n      avatar: user.avatar\n    });\n  }, [user]);\n\n  useEffect(() => {\n    if (user.avatar) {\n      getAvatarApi(user.avatar).then(response => {\n        setAvatar(response);\n      });\n    } else {\n      setAvatar(null);\n    }\n  }, [user]);\n\n  useEffect(() => {\n    if (avatar) {\n      setUserData({ ...userData, avatar: avatar.file });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [avatar]);\n\n  const updateUser = e => {\n    e.preventDefault();\n    const token = getAccessTokenApi();\n    let userUpdate = userData;\n\n    if (userUpdate.password || userUpdate.repeatPassword) {\n      if (userUpdate.password !== userUpdate.repeatPassword) {\n        notification[\"error\"]({\n          message: \"Las contraseÃ±as tienen que ser iguales.\"\n        });\n        return;\n      } else {\n        delete userUpdate.repeatPassword;\n      }\n    }\n\n    if (!userUpdate.name || !userUpdate.lastname || !userUpdate.email) {\n      notification[\"error\"]({\n        message: \"El nombre, apellidos y email son obligatorios.\"\n      });\n      return;\n    }\n\n    if (typeof userUpdate.avatar === \"object\") {\n      uploadAvatarApi(token, userUpdate.avatar, user._id).then(response => {\n        userUpdate.avatar = response.avatarName;\n        updateUserApi(token, userUpdate, user._id).then(result => {\n          notification[\"success\"]({\n            message: result.message\n          });\n          setIsVisibleModal(false);\n          setReloadUsers(true);\n        });\n      });\n    } else {\n      updateUserApi(token, userUpdate, user._id).then(result => {\n        notification[\"success\"]({\n          message: result.message\n        });\n        setIsVisibleModal(false);\n        setReloadUsers(true);\n      });\n    }\n  };\n\n  return (\n    <div className=\"edit-user-form\">\n      <UploadAvatar avatar={avatar} setAvatar={setAvatar} />\n      <EditForm\n        userData={userData}\n        setUserData={setUserData}\n        updateUser={updateUser}\n      />\n    </div>\n  );\n}\n\nfunction UploadAvatar(props) {\n  const { avatar, setAvatar } = props;\n  const [avatarUrl, setAvatarUrl] = useState(null);\n\n  useEffect(() => {\n    if (avatar) {\n      if (avatar.preview) {\n        setAvatarUrl(avatar.preview);\n      } else {\n        setAvatarUrl(avatar);\n      }\n    } else {\n      setAvatarUrl(null);\n    }\n  }, [avatar]);\n\n  const onDrop = useCallback(\n    acceptedFiles => {\n      const file = acceptedFiles[0];\n      setAvatar({ file, preview: URL.createObjectURL(file) });\n    },\n    [setAvatar]\n  );\n\n  const { getRootProps, getInputProps, isDragActive } = useDropzone({\n    accept: \"image/jpeg, image/png\",\n    noKeyboard: true,\n    onDrop\n  });\n\n  return (\n    <div className=\"upload-avatar\" {...getRootProps()}>\n      <input {...getInputProps()} />\n      {isDragActive ? (\n        <Avatar size={150} src={NoAvatar} />\n      ) : (\n        <Avatar size={150} src={avatarUrl ? avatarUrl : NoAvatar} />\n      )}\n    </div>\n  );\n}\n\nfunction EditForm(props) {\n  const { userData, setUserData, updateUser } = props;\n  const { Option } = Select;\n\n  return (\n    <Form className=\"form-edit\" onSubmit={updateUser}>\n      <Row gutter={24}>\n        <Col span={12}>\n          <Form.Item>\n            <Input\n              prefix={<Icon type=\"user\" />}\n              placeholder=\"Nombre\"\n              value={userData.name}\n              onChange={e => setUserData({ ...userData, name: e.target.value })}\n            />\n          </Form.Item>\n        </Col>\n        <Col span={12}>\n          <Form.Item>\n            <Input\n              prefix={<Icon type=\"user\" />}\n              placeholder=\"Apellidos\"\n              value={userData.lastname}\n              onChange={e =>\n                setUserData({ ...userData, lastname: e.target.value })\n              }\n            />\n          </Form.Item>\n        </Col>\n      </Row>\n\n      <Row gutter={24}>\n        <Col span={12}>\n          <Form.Item>\n            <Input\n              prefix={<Icon type=\"mail\" />}\n              placeholder=\"Correo electronico\"\n              value={userData.email}\n              onChange={e =>\n                setUserData({ ...userData, email: e.target.value })\n              }\n            />\n          </Form.Item>\n        </Col>\n        <Col span={12}>\n          <Form.Item>\n            <Select\n              placeholder=\"SelecciÃ³na una rol\"\n              onChange={e => setUserData({ ...userData, role: e })}\n              value={userData.role}\n            >\n              <Option value=\"admin\">Administrador</Option>\n              <Option value=\"editor\">Editor</Option>\n              <Option value=\"reviewr\">Revisor</Option>\n            </Select>\n          </Form.Item>\n        </Col>\n      </Row>\n\n      <Row gutter={24}>\n        <Col span={12}>\n          <Form.Item>\n            <Input\n              prefix={<Icon type=\"lock\" />}\n              type=\"password\"\n              placeholder=\"ContraseÃ±a\"\n              onChange={e =>\n                setUserData({ ...userData, password: e.target.value })\n              }\n            />\n          </Form.Item>\n        </Col>\n        <Col span={12}>\n          <Form.Item>\n            <Input\n              prefix={<Icon type=\"lock\" />}\n              type=\"password\"\n              placeholder=\"Repetir contraseÃ±a\"\n              onChange={e =>\n                setUserData({ ...userData, repeatPassword: e.target.value })\n              }\n            />\n          </Form.Item>\n        </Col>\n      </Row>\n\n      <Form.Item>\n        <Button type=\"primary\" htmlType=\"submit\" className=\"btn-submit\">\n          Actualizar Usuario\n        </Button>\n      </Form.Item>\n    </Form>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}